# System-programing-Project
## A. 프로젝트 명
### **라즈베리파이를 이용한 비트코인 모의 투자 프로그램**
 - Java의 오픈 라이브러리와 오픈 API를 활용하여, 라즈베리파이로 모의 투자 및 웹 서버 구축


## B. 프로젝트 멤버 이름 및 멤버 별로 담당한 파트에 대한 소개
### **박준현(팀장)**
```
- json 라이브러리를 활용하여 빗썸의 오픈 API를 이용한 모의투자 프로그램 알고리즘 설계
- okhttp3 라이브러리(HttpModule.java)를 활용하여 Main 함수(App.java) 구현
- 스레드를 활용한 실행여부, 매수, 매도에 따른 라즈베리파이 LED 구현
```

### **김중권**
```
- Raspbian OS 설치 및 셋팅 (라즈베리파이에서 LED 작동을 위한 회로도 설계 및 연결 포함)
- Web 디자인 설계 및 로그 파일과 연동, Form 제작 (라즈베리파이 서버 시간을 한국 시간으로 변경)
- 비트코인 알고리즘에 따른 누적 Log 파일 생성 코드 구현
```
  
이외 멤버 없음.


## C. 프로젝트 소개 및 개발 내용 소개
### **프로젝트 소개**
  　'라즈베리파이를 이용한 비트코인 모의투자 프로그램'은 자본금 1억으로 비트코인을 모의거래하며 시간, 날짜별로 거래 동향을 알아볼 수 있는 프로그램입니다.
국내 가상화폐 거래소 중 실 거래량이 가장 많은 플랫폼인 '빗썸'은 사용자가 직접 프로그램과 서비스를 개발할 수 있도록 open api를 제공합니다.
이 프로젝트는 대표적인 가상화폐인 비트코인(Bitcoin) api를 활용하여 제작되었습니다.

   　빗썸을 통한 가상화폐 거래는 실제 자산으로 이루어지고 있기 때문에 항상 손실을 감안해야 합니다. 
 가상화폐 투자자는 실제 투자를 진행하기 전에 장의 흐름을 파악하는 일이 요구됩니다. 
 소액 투자는 장의 흐름을 파악하기 좋은 수단이지만, 손실을 감안해야 하는 위험이 따릅니다. 
 모의의 자산으로 투자를 한다면 자본 손실 없이 장의 흐름을 파악할 수 있습니다.

   　비트코인 모의투자 프로그램은 빗썸 api를 토대로 비트코인의 현재가 데이터를 활용하여 모의투자를 진행합니다.
 프로그램은 3분 동안의 평균 단가를 계산하여 자동으로 거래가 진행되며, 어떻게든 수익을 볼 수 있게끔 알고리즘이 구성되어 있습니다.
 초기 자본을 1억으로 설정하여 현재가가 평균 단가의 0.3% 이하로 떨어진다면 매수를 하고, 매수 평균가의 0.3% 이상이 되면 매도를 합니다.
 모든 데이터 처리는 Raspbian OS 환경에서 진행되며, 사용자는 web으로 잔고 현황과 거래 내역 데이터 조회가 가능합니다.


### **개발 내용 소개**
　프로그램을 실행하면 3분 동안 최근 체결가를 계산하여 평균값을 구합니다. (이 동작은 프로그램이 실행되는 동안 계속 반복됩니다.) 3분 동안의 평균 체결가를 기준으로 0.3% 하락하면 매수를 진행하고, 매수 평균가를 계산하여 0.3% 상승하면 매도를 진행합니다. 매수 조건이 충족되더라도 예수금이 300,000원 이하로 남는다면 매수하지 않습니다. 

Java 언어로 전반적인 코드를 작성하였으며 작성된 코드는 jar 형식으로 변환하여 Raspbian OS 환경에서 실행됩니다. Raspbian에서 처리된 데이터를 웹으로 전송하기 위해 nginx를 사용했습니다. 또한 Json 형식으로 구성된 api의 데이터를 활용하기 위해 http 통신이 가능한 OkHttp3 라이브러리를 사용했습니다. api가 제공하는 매수 주문 체결가, 매도 주문 체결가, 오류 코드 데이터가 프로그램이 동작하는 주 데이터입니다.

빗썸 api는 1초당 최대 135회까지 요청 가능하며 135회를 초과하는 경우 Public api 기준으로 1분간 사용이 제한됩니다. 모의투자 프로그램은 오픈 API 서버에 따라 1초당 약 5~10회 요청하도록 알고리즘이 구성되어 있습니다.

라즈베리파이의 브래드 보드에 rgb led를 장착해서 체결이 이뤄질 때마다 각각의 led 색으로 체결 종류를 확인할 수 있습니다. (RED: 매도, GREEN: 정상 동작 중, BLUE: 매수)

체결이 이뤄질 때마다 체결 내역 로그파일을 저장합니다. 현재가, 총 거래 내역, 매수, 매도, 예수금, 보유 코인으로 총 6가지 파일로 구성되어 있습니다. 거래 내역과 매수, 매도 로그는 지속적으로 데이터가 쌓이며, 예수금과 보유 코인 로그는 체결될 때마다 데이터가 변합니다.

사용자가 체결 내역, 잔고 현황을 웹을 통해 간단히 볼 수 있게 html코드를 작성했습니다. 웹에서 현재가, 예수금, 보유Bitcoin, 매수 내역, 매도 내역을 확인할 수 있으며 해당 로그 데이터는 nginx를 통해 전달됩니다. 5초마다 새로운 데이터가 로드되며 정지버튼으로 로드되는 것을 멈출 수 있습니다.

## D. 프로젝트 개발 결과물 소개 (+ 다이어그램)
![다이어그램](https://user-images.githubusercontent.com/62891711/101587487-a584a000-3a27-11eb-8b61-6ba77c2bf4b5.png)
* maven을 통하여 okhttp3 라이브러리와 json 라이브러리, 1.3-SNAPSHOT 라이브러리를 pom.xml에 등록 후 사용했습니다.
* okhttp3 라이브러리로 빗썸의 오픈 비트코인 API(JSON 코드) 주소의 내용을 string으로 저장 후 json 라이브러리로 객체를 생성하여 알고리즘을 구현했습니다.
* 1.3-SNAPSHOT 라이브러리를 이용하여 라즈베리파이에서 매도(R), 실행(G), 매수(B) 따른 LED 색이 나올 수 있도록 구현했습니다.
* 제작 언어는 자바이며, 웹에서 로그 파일을 볼 수 있도록 자바스크립트와 HTML, CSS로 만들었습니다.
* 사용자는 웹에서 5초동안 자동적으로 로딩되는 로그 파일들을 볼 수 있으며, 현재 예수금과 비트코인 개수를 볼 수 있습니다.
   + 현재가는 서버에서 값이 변경될 때마 지속적으로 로그파일이 변경되기 때문에 새로고침으로 바뀌는 모습을 볼 수 있습니다.
* 웹에서 정지 버튼을 누르면 자동적으로 로그가 로딩되는 것을 중지할 수 있으며 새로고침을 통하여 다시 자동적으로 로그가 불러오도록 할 수 있습니다.
  + 정지 버튼을 누를 경우, 하단의 로그파일을 불러온 시간도 같이 멈추게 됩니다.
* **라즈베리파이에서 원활한 구동을 위해 메모리 관리를 철저히 하여 24시간 넘게 구동할 수 있도록 구현했습니다.**


## E. 개발 결과물을 사용하는 방법 소개
### 초기화면
![제목 없음-3](https://user-images.githubusercontent.com/62891711/101605786-f2776f00-3a45-11eb-98f6-e2e606d4715f.png)

---

#### 라즈베리파이 모의투자 프로그램
1. 라즈베리 파이의 전원을 연결합니다.
(라즈베리 파이 전원 연결 모습)

2. nginx 서버의 연결을 확인합니다. (접속이 되는지 확인)
라즈베리파이 전원이 연결되면 nginx 서버는 자동으로 실행되도록 구현했습니다.
      + nginx 재시작 명령어: sudo service nginx start

3. jar 파일이 저장된 경로로 이동 후, 모의투자 프로그램을 명령어로 실행합니다.
    - 실행 명령어: ![start](https://user-images.githubusercontent.com/62891711/101595967-9d346100-3a37-11eb-9cd0-ffa18bf353b7.png)
- 라즈베리파이에서 LED는 프로그램이 실행중이면 녹색LED가 계속 들어오며, 스레드로 매수와 매도가 진행될 때마다 2초간 LED가 켜졌다가 꺼지고, 
불이 켜진 도중에 매수와 매도가 들어올 경우 불이 순간적으로 깜빡이며 2초간 불이 켜지게 됩니다.
    + 스레드로 LED를 작동시키므로 LED가 켜지고 꺼지는 사이에 sleep을 걸어도 모의투자 프로그램은 지속적으로 돌아가게 됩니다.

---

#### 라즈베리파이 웹서버 접속
![웹](https://user-images.githubusercontent.com/62891711/101607245-b513e100-3a47-11eb-98f7-b44c1f4de3a1.png)
1. 웹브라우저로 라즈베리파이의 주소로 접속합니다
    + 공유기 DDNS 설정 후 포드포워딩으로 라즈베리파이의 80 포트를 열어서 외부에서도 접속할 수 있도록 하였습니다.
2. 자동적으로 브라우저에서 5초마다 log파일을 갱신합니다.
    + 정지 버튼을 눌러서 갱신되는 것을 멈출 수 있으며, 갱신이 중단된 시간은 하단에서 확인하면 됩니다.
  

## F. 개발 결과물의 필요성 및 활용방안
### 필요성
  　빗썸은 실제 자산과 가상화폐의 거래 기능을 지원하는 플랫폼입니다. 사용자는 빗썸을 통해 모의거래를 해볼 수 없기 때문에 비트코인을 거래하기 위해서 가상계좌를 개설한 뒤 입금을 하고 거래를 진행해야 합니다. 또한, 빗썸은 가상화폐 거래와 입출금 과정에서 수수료가 발생됩니다. 모의투자 프로그램을 사용한다면 위의 과정을 거칠 필요 없이 가상의 자산으로 손실 없는 투자를 경험해볼 수 있습니다.

 모의투자는 실제 자산이 아닌 가상의 자산으로 투자를 흉내 내는 것입니다. 실제 자산을 잃을 걱정 없이 투자 기술을 익히고 장의 흐름을 파악할 수 있습니다. 비트코인 투자 경험이 전무한 사용자 뿐만 아닌, 기존 투자자들 또한 모의투자 프로그램을 사용함으로써 매수와 매도 타이밍을 파악할 수 있습니다. 
 
 비트코인은 다른 코인(알트코인)들과 달리 상승, 하락폭이 넓기 때문에 시간이 조금만 지나도 차트는 꾸준히 변동합니다. 모의투자 프로그램은 사용자가 자리를 비운 순간에도 모의자산으로 거래를 진행하기 때문에 사용자는 로그파일을 조회하며 비트코인의 시세 동향을 쉽게 파악할 수 있습니다.


### 활용방안
 Open api를 활용하여 제작된 프로그램이기 때문에 비트코인 뿐만아닌 알트코인 모의투자도 가능합니다. 증권사에서 제공하는 Open api를 활용한다면 주식 모의투자 또한 가능합니다.
 모의투자 프로그램을 실행하며 쌓인 로그파일을 차트 데이터로 활용한다면 텍스트 로그와 함께 차트를 통한 시세 분석이 가능합니다. 분석한 데이터를 계산하여 다시 알고리즘의 값으로 활용하면 보다 높은 수익을 볼 수 있을 것입니다.
  
